<mat-expansion-panel>
  <mat-expansion-panel-header>
    <mat-panel-title>Filters</mat-panel-title>
  </mat-expansion-panel-header>

  <form [formGroup]="filter()">
    <mat-form-field>
      <mat-label>From</mat-label>
      <input formControlName="dateFrom" matInput [matDatepicker]="from" readonly (click)="from.open()">
      <mat-datepicker touchUi #from></mat-datepicker>
      <button mat-icon-button matSuffix (click)="filter().patchValue({dateFrom: null})">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <mat-form-field>
      <mat-label>To</mat-label>
      <input formControlName="dateTo" matInput [matDatepicker]="to" readonly (click)="to.open()">
      <mat-datepicker touchUi #to></mat-datepicker>
      <button mat-icon-button matSuffix (click)="filter().patchValue({dateTo: null})">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Type</mat-label>
      <mat-select formControlName="type">
        <mat-option [value]="null">[Empty]</mat-option>
        <mat-option *ngFor="let type of types" [value]="type.value">{{type.label}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Account</mat-label>
      <reference-input api="/account/reference" formControlName="account"></reference-input>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Currency</mat-label>
      <mat-select formControlName="currency">
        <mat-option [value]="null">[Empty]</mat-option>
        <mat-option *ngFor="let currency of settingsService.settings.currencies" [value]="currency">{{currency}}</mat-option>
      </mat-select>
    </mat-form-field>
  </form>

  <mat-paginator [hidePageSize]="true"
                 [showFirstLastButtons]="true"
                 [pageIndex]="documentPage().page"
                 [length]="documentPage().total"
                 (page)="onPage($event)"></mat-paginator>

</mat-expansion-panel>

<mat-card class="browser" *ngIf="documentPage().documents.length > 0">
  <mat-list>
    <mat-list-item *ngFor="let document of documentPage().documents" [matMenuTriggerFor]="menu">
      <document-label [document]="document"></document-label>
      <mat-menu #menu>
        <button mat-menu-item (click)="edit(document.value.id!)">Edit</button>
        <button mat-menu-item (click)="delete(document.value.id!)">Delete</button>
      </mat-menu>
    </mat-list-item>
  </mat-list>
</mat-card>

<button class="fab" mat-fab (click)="select()">
  <mat-icon>add</mat-icon>
</button>

<div class="select" *ngIf="selection" (click)="selection = false">
  <mat-card (click)="$event.stopPropagation()">
    <mat-action-list>
      <button mat-list-item (click)="add('expense')">Expense</button>
      <button mat-list-item (click)="add('income')">Income</button>
      <button mat-list-item (click)="add('exchange')">Exchange</button>
    </mat-action-list>
  </mat-card>
</div>
